## ChatGPT-basierte Extraktion von Architekturmodellen

**Authors:** Hoang Hai Tran, Tim Le Large  
**Course:** 'Praktikum: Werkzeuge für Agile Modellierung'  
**Mentors:** Yves Kirschner, Kai Marquardt

### Prerequisites and Setup

Before you begin setting up the project, please ensure you complete the following steps:

1. **Install Apache Maven 3.8.7**
   - Download and install Apache Maven 3.8.7 from the [official release notes](https://maven.apache.org/docs/3.8.7/release-notes.html).

2. **Install Java 17**
   - Download and install the latest version of Java 17 from [Adoptium](https://adoptium.net/de/temurin/releases/?version=17).

3. **Download and Install Eclipse Modeling Tools Version 2023-03**
   - Navigate to the [Eclipse Modeling Tools download page](https://www.eclipse.org/downloads/packages/release/2023-03/r/eclipse-modeling-tools) and download the installer or archive.
   - Follow the installation instructions to set up Eclipse Modeling Tools.

4. **Install Retriever-Update-Site**
   - Open Eclipse and navigate to `Help` > `Eclipse Marketplace...`.
   - Click on `Install New Software...` and enter the following update site URL: [Palladio Reverse Engineering Retriever Update Site](https://updatesite.palladio-simulator.com/palladio-reverseengineering-retriever-updatesite/nightly/).
   - Follow the prompts to complete the installation of the necessary plugins.
  
5. **Project configuration**
   - It is also important to add the projects that are supposed to be analysed to the [data](data/) folder
   - ![Example configuration](pictures/example.png)

---

### Project Configuration

Ensure you have the following dependencies in your `pom.xml` file to set up the project:

- **ChatGPT API Library**
  - **Group ID:** `com.github.plexpt`
  - **Artifact ID:** `chatgpt`
  - **Version:** `5.1.1`

- **PlantUML Library**
  - **Group ID:** `net.sourceforge.plantuml`
  - **Artifact ID:** `plantuml`
  - **Version:** `1.2023.7`

---

### Results

Some example results can be found in different locations:

1. **Logs**
   - Past executions of the programm, including the full prompt and the resulting PlantUml description in [logfolder](data/results/)

2. **GPT generated UML as png**
   - [PiggyMetricsUML](umls/PiggyMetricsGPTuml.png)
   - [AcmeAirUML](umls/AcmeAirGPTuml.png)
  
---

### Using the ChatGPT API in Java

To integrate the ChatGPT API into your Java project, follow these steps:

1. **Add Maven Dependency**
   - Ensure the required dependencies are included in your Maven `pom.xml`.

2. **Configure API Key**
   - Obtain an API key from the ChatGPT provider and configure it in your Java application. Refer to the library's documentation for details on how to set up the API key.

3. **Implement ChatGPT Integration**
   - Use the `chatgpt` library to implement ChatGPT functionality in your Java application. Follow the library's documentation to understand how to create prompts, send requests, and handle responses.

---

### Reverse Engineering with ChatGPT

This project leverages ChatGPT for reverse engineering software architecture models. Here’s how ChatGPT can be used in this context:

1. **Extracted Features from Source Code**
   The following features were extracted from the source code for further analysis:

   - **Class**: `ResourceServerConfig`
   - **Extends**: `ResourceServerConfigurerAdapter`
   - **Package**: `com.piggymetrics.account.config`
   - **Imports**: `@Configuration`, `@EnableResourceServer`
   - **Fields**: 
     - `sso`: `ResourceServerProperties` (private, final)
   - **Methods**:
     - `ResourceServerConfig(ResourceServerProperties sso)`
     - `clientCredentialsResourceDetails(): ClientCredentialsResourceDetails`
     - `oauth2FeignRequestInterceptor(): RequestInterceptor`
     - `clientCredentialsRestTemplate(): OAuth2RestTemplate`
     - `tokenServices(): ResourceServerTokenServices`
     - `configure(HttpSecurity http): void`

2. **Integration with PlantUML**
   - Use PlantUML to render the diagrams created by ChatGPT. PlantUML is a tool that can interpret textual descriptions of diagrams and generate visual representations.
---

### Prompt Engineering and Patterns

Prompt engineering is a key aspect of this project, as the quality of the output generated by ChatGPT is directly influenced by the quality of the prompts provided. In this project, we use the following **prompt patterns** to systematically improve interaction with the model:

1. **Flipped Interaction Pattern**  
   A pattern that reverses the expected flow of information by asking the model to anticipate the user’s needs before a specific prompt is given.
   
2. **Recipe Pattern**  
   A step-by-step prompt pattern where the model is guided through a process in logical steps, ensuring consistency and clarity in its output.
   
3. **Persona Pattern**  
   Involves asking the model to assume a specific role (e.g., as a system architect) to better align its responses with the desired perspective.
   
4. **Template Pattern**  
   A structured prompt pattern that follows a strict format, making it easier for the model to generate consistent and interpretable results.

Source: [A Prompt Pattern Catalog to Enhance Prompt Engineering with ChatGPT](https://arxiv.org/abs/2305.01618)

The usage of these patterns enables a more systematic approach to generating accurate and relevant diagrams that align with the extracted features from the source code.

---

If you have any questions or need further assistance, please feel free to contact us.

**Best regards,**  
Tim and Hai
